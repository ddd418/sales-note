# ν€λ„¬ μ •λ³΄ μμ • λ²„κ·Έ μμ • μ™„λ£

## π› λ¬Έμ  μƒν™©

1. λ―Έν… μƒμ„± μ‹ ν€λ„¬ μ •λ³΄ μ…λ ¥ μ• ν•¨ β†’ OpportunityTracking μƒμ„± μ• λ¨ β… (μ •μƒ)
2. μ¶”ν›„ μΌμ •μ—μ„ ν€λ„¬ μ •λ³΄ μμ • β†’ OpportunityTracking μ—…λ°μ΄νΈ μ• λ¨ β (λ²„κ·Έ)

## π”§ μμ • λ‚΄μ©

### κΈ°μ΅΄ λ΅μ§

```python
# schedule_update_funnel ν•¨μ
schedule.save()
# OpportunityTracking μ—…λ°μ΄νΈλ” pre_save μ‹κ·Έλ„μ—μ„ μλ™μΌλ΅ μ²λ¦¬λ¨
```

**λ¬Έμ μ :**

- `pre_save` μ‹κ·Έλ„μ€ `instance.opportunity`κ°€ μμ„ λ•λ§ μ—…λ°μ΄νΈ
- OpportunityTrackingμ΄ μ—†μΌλ©΄ μƒμ„±ν•μ§€ μ•μ

### μμ •λ λ΅μ§

```python
# schedule_update_funnel ν•¨μ
schedule.save()

# OpportunityTracking μƒμ„± λλ” μ—…λ°μ΄νΈ
if schedule.activity_type != 'service':
    if not schedule.opportunity:
        # OpportunityTracking μƒλ΅ μƒμ„±
        opportunity = OpportunityTracking.objects.create(...)
        schedule.opportunity = opportunity
        schedule.save()
    else:
        # OpportunityTracking μ—…λ°μ΄νΈ
        opportunity = schedule.opportunity
        opportunity.expected_revenue = schedule.expected_revenue
        opportunity.probability = schedule.probability
        opportunity.expected_close_date = schedule.expected_close_date
        opportunity.save()
```

## β… μμ • ν›„ λ™μ‘

### μ‹λ‚λ¦¬μ¤ 1: ν€λ„¬ μ •λ³΄ μ—†μ΄ μƒμ„± β†’ λ‚μ¤‘μ— μμ •

1. **λ―Έν… μƒμ„± (ν€λ„¬ μ •λ³΄ μ—†μ)**

   - OpportunityTracking μƒμ„± μ• λ¨ β…
   - ν€λ„¬ λ€μ‹λ³΄λ“μ— ν‘μ‹ μ• λ¨ β…

2. **μΌμ • μƒμ„Έμ—μ„ ν€λ„¬ μ •λ³΄ μμ •**
   - OpportunityTracking μλ™ μƒμ„± β…
   - μμƒ λ§¤μ¶, ν™•λ¥ , μμƒ κ³„μ•½μΌ μ €μ¥ β…
   - κ°€μ¤‘ μμƒ λ§¤μ¶ μλ™ κ³„μ‚° β…
   - ν€λ„¬ λ€μ‹λ³΄λ“μ— ν‘μ‹ β…

### μ‹λ‚λ¦¬μ¤ 2: ν€λ„¬ μ •λ³΄ μκ² μƒμ„± β†’ λ‚μ¤‘μ— μμ •

1. **λ―Έν… μƒμ„± (ν€λ„¬ μ •λ³΄ μ…λ ¥)**

   - OpportunityTracking μƒμ„± β…
   - ν€λ„¬ λ€μ‹λ³΄λ“μ— ν‘μ‹ β…

2. **μΌμ • μƒμ„Έμ—μ„ ν€λ„¬ μ •λ³΄ μμ •**
   - OpportunityTracking μ—…λ°μ΄νΈ β…
   - μμƒ λ§¤μ¶, ν™•λ¥ , μμƒ κ³„μ•½μΌ μμ • β…
   - κ°€μ¤‘ μμƒ λ§¤μ¶ μλ™ μ¬κ³„μ‚° β…
   - ν€λ„¬ λ€μ‹λ³΄λ“μ— μ—…λ°μ΄νΈ λ°μ β…

## π― μ΄κΈ° λ‹¨κ³„ μ„¤μ •

μΌμ • νƒ€μ…μ— λ”°λΌ μ μ ν• ν€λ„¬ λ‹¨κ³„λ΅ μ‹μ‘:

| μΌμ • νƒ€μ…                    | μ΄κΈ° ν€λ„¬ λ‹¨κ³„        |
| ---------------------------- | --------------------- |
| κ³ κ° λ―Έν… (customer_meeting) | **lead** (μ μ¬κ³ κ°)   |
| κ²¬μ  (quote)                 | **quote** (κ²¬μ  μ μ¶) |
| λ‚©ν’ (delivery)              | **closing** (ν΄λ΅μ§•)  |
| κΈ°νƒ€                         | **contact** (μ ‘μ΄‰)    |

## π§ ν…μ¤νΈ λ°©λ²•

### ν…μ¤νΈ 1: ν€λ„¬ μ •λ³΄ μ—†μ΄ μƒμ„± ν›„ μμ •

```
1. μƒ λ―Έν… μƒμ„±
   - ν€λ„¬ μ •λ³΄ μ…λ ¥ν•μ§€ μ•μ
   - "μ €μ¥" ν΄λ¦­

2. ν€λ„¬ λ€μ‹λ³΄λ“ ν™•μΈ
   - ν•΄λ‹Ή λ―Έν… ν‘μ‹ μ• λ¨ β…

3. μΌμ • μƒμ„Έ νμ΄μ§€ μ΄λ™
   - "ν€λ„¬ μ •λ³΄ μμ •" ν΄λ¦­
   - μμƒ λ§¤μ¶: 10,000,000 μ…λ ¥
   - ν™•λ¥ : 70% μ…λ ¥
   - μμƒ κ³„μ•½μΌ: 2025-12-31 μ…λ ¥
   - "μ €μ¥" ν΄λ¦­

4. ν€λ„¬ λ€μ‹λ³΄λ“ μ¬ν™•μΈ
   - ν•΄λ‹Ή λ―Έν… ν‘μ‹λ¨ β…
   - μμƒ λ§¤μ¶: 10,000,000μ› β…
   - κ°€μ¤‘ μμƒ: 7,000,000μ› (10,000,000 Γ— 70%) β…
   - λ‹¨κ³„: lead β…
```

### ν…μ¤νΈ 2: ν€λ„¬ μ •λ³΄ μμ •

```
1. κΈ°μ΅΄ μΌμ • μ—΄κΈ° (OpportunityTracking μμ)

2. "ν€λ„¬ μ •λ³΄ μμ •" ν΄λ¦­
   - μμƒ λ§¤μ¶: 15,000,000μΌλ΅ λ³€κ²½
   - ν™•λ¥ : 80%λ΅ λ³€κ²½
   - "μ €μ¥" ν΄λ¦­

3. ν€λ„¬ λ€μ‹λ³΄λ“ ν™•μΈ
   - μμƒ λ§¤μ¶: 15,000,000μ› β…
   - κ°€μ¤‘ μμƒ: 12,000,000μ› (15,000,000 Γ— 80%) β…
```

## π“ λ΅κ·Έ ν™•μΈ

μμ • κ³Όμ •μ΄ λ΅κ·Έμ— κΈ°λ΅λ©λ‹λ‹¤:

```
INFO: ν€λ„¬ μ •λ³΄ μ—…λ°μ΄νΈ μ”μ²­ - μ‚¬μ©μ: user1, μΌμ • ID: 123
INFO: μ—…λ°μ΄νΈν•  κ°’ - μμƒλ§¤μ¶: 10000000, ν™•λ¥ : 70, λ§κ°μΌ: 2025-12-31
INFO: λ³€ν™λ κ°’ - μμƒλ§¤μ¶: 10000000, ν™•λ¥ : 70, λ§κ°μΌ: 2025-12-31
INFO: μΌμ • 123 ν€λ„¬ μ •λ³΄ μ—…λ°μ΄νΈ μ™„λ£
INFO: OpportunityTracking μ—†μ - μƒλ΅ μƒμ„±
INFO: OpportunityTracking 456 μƒμ„± λ° μ—°κ²° μ™„λ£
```

λλ” (OpportunityTrackingμ΄ μ΄λ―Έ μλ” κ²½μ°):

```
INFO: OpportunityTracking 456 μ—…λ°μ΄νΈ
INFO: OpportunityTracking 456 μ—…λ°μ΄νΈ μ™„λ£
```

## π‰ μ™„μ„±!

μ΄μ  μ–Έμ λ“ μ§€ μΌμ •μ—μ„ ν€λ„¬ μ •λ³΄λ¥Ό μμ •ν•λ©΄:

- OpportunityTrackingμ΄ μ—†μΌλ©΄ μλ™ μƒμ„± β…
- OpportunityTrackingμ΄ μμΌλ©΄ μ—…λ°μ΄νΈ β…
- ν€λ„¬ λ€μ‹λ³΄λ“μ— μ¦‰μ‹ λ°μ β…
