<!-- reporting/templates/reporting/base.html -->
<!DOCTYPE html>
<html lang="ko">  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="csrf-token" content="{{ csrf_token }}" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <title>{% block title %}ì˜ì—… ë³´ê³  ì‹œìŠ¤í…œ{% endblock %}</title>
    {% load static %}
    <link href="{% static 'css/dist/styles.css' %}" rel="stylesheet" />
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Bootstrap CSS (if not already included) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        margin: 0;
        background-color: #fcfcfc; /* Notion ë°°ê²½ìƒ‰ê³¼ ìœ ì‚¬í•˜ê²Œ ë³€ê²½ */
        color: #37352f;
        display: flex; /* ì‚¬ì´ë“œë°”ì™€ ì»¨í…ì¸  ì˜ì—­ ë¶„ë¦¬ë¥¼ ìœ„í•´ flex ì‚¬ìš© (ì¶”í›„ í™•ì¥ ê³ ë ¤) */
        min-height: 100vh;
        position: relative;
      }      /* ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ */
      .mobile-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1049;
      }

      .mobile-overlay.show {
        display: block;
      }

      /* ëª¨ë°”ì¼ í–„ë²„ê±° ë©”ë‰´ */
      .mobile-menu-toggle {
        display: none;
        position: fixed;
        top: 15px;
        left: 15px;
        z-index: 1051;
        background: #fff;
        border: 1px solid #e3e2e0;
        border-radius: 8px;
        padding: 8px 12px;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .mobile-menu-toggle i {
        font-size: 18px;
        color: #37352f;
      }

      /* ê¸°ë³¸ ë„¤ë¹„ê²Œì´ì…˜ (ì¶”í›„ ì‚¬ì´ë“œë°”ë¡œ ë³€ê²½ ê°€ëŠ¥) */
      .main-nav {
        background-color: #ffffff;
        border-right: 1px solid #edecec; /* Notion ì‚¬ì´ë“œë°” ê²½ê³„ì„ ê³¼ ìœ ì‚¬í•˜ê²Œ */
        padding: 20px;
        width: 240px; /* ì‚¬ì´ë“œë°” ë„ˆë¹„ */
        display: flex;
        flex-direction: column;
        position: relative;
        z-index: 1050;
        transition: transform 0.3s ease;
      }

      .main-nav .logo {
        font-size: 20px;
        font-weight: 600;
        color: #37352f;
        text-decoration: none;
        margin-bottom: 30px;
        display: block;
      }

      .main-nav ul {
        list-style: none;
        padding: 0;
        margin: 0;
        flex-grow: 1;
      }

      .main-nav ul li a {
        display: block;
        padding: 10px 15px;
        color: #5c5a53; /* Notion ë©”ë‰´ ì•„ì´í…œ ìƒ‰ìƒê³¼ ìœ ì‚¬í•˜ê²Œ */
        text-decoration: none;
        border-radius: 4px;
        margin-bottom: 5px;
        transition: background-color 0.2s, color 0.2s;
      }

      .main-nav ul li a:hover,
      .main-nav ul li a.active {
        background-color: #ebeaeb; /* Notion ë©”ë‰´ í˜¸ë²„/í™œì„± ìƒ‰ìƒ */
        color: #37352f;
      }

      .main-nav .user-actions {
        margin-top: auto; /* ì‚¬ìš©ì ì•¡ì…˜ ë²„íŠ¼ì„ í•˜ë‹¨ìœ¼ë¡œ ë°€ê¸° */
      }

      .main-nav .user-actions a {
        display: block;
        padding: 10px 15px;
        color: #5c5a53;
        text-decoration: none;
        border-radius: 4px;
        transition: background-color 0.2s, color 0.2s;
        text-align: center;
        border: 1px solid #e3e2e0; /* ë²„íŠ¼ í…Œë‘ë¦¬ */
        margin-top: 10px;
      }

      .main-nav .user-actions a:hover {
        background-color: #f7f7f5;
        color: #37352f;
      }

      .main-content {
        flex-grow: 1;
        padding: 0; /* ìƒë‹¨ í—¤ë”ë¥¼ ìœ„í•´ íŒ¨ë”© ì œê±° */
        overflow-y: auto; /* ì»¨í…ì¸ ê°€ ê¸¸ì–´ì§ˆ ê²½ìš° ìŠ¤í¬ë¡¤ */
      }
      
      /* ìƒë‹¨ í—¤ë” ë°” */
      .top-header-bar {
        background-color: #ffffff;
        border-bottom: 1px solid #edecec;
        padding: 15px 30px;
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      
      .page-title h5 {
        color: #37352f;
        font-weight: 600;
        margin: 0;
      }
      
      .user-actions-top {
        display: flex;
        align-items: center;
      }
      
      .user-info-compact {
        color: #37352f;
        font-size: 14px;
        font-weight: 500;
      }
      
      .logout-btn-top {
        padding: 8px 16px;
        background: linear-gradient(135deg, #dc3545, #c82333);
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
      }
      
      .logout-btn-top:hover {
        background: linear-gradient(135deg, #c82333, #bd2130);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
      }
      
      .logout-btn-top:active {
        transform: translateY(0);
        box-shadow: 0 2px 6px rgba(220, 53, 69, 0.3);
      }
      
      .login-btn-top {
        padding: 8px 16px;
        background: linear-gradient(135deg, #007bff, #0056b3);
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        text-decoration: none;
      }
      
      .login-btn-top:hover {
        background: linear-gradient(135deg, #0056b3, #004494);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        color: white;
        text-decoration: none;
      }
      
      .login-btn-top:active {
        transform: translateY(0);
        box-shadow: 0 2px 6px rgba(0, 123, 255, 0.3);
      }
      
      /* ëª¨ë°”ì¼ ë°˜ì‘í˜• - ìƒë‹¨ í—¤ë” */
      @media (max-width: 768px) {
        .top-header-bar {
          padding: 10px 15px;
        }
        
        .page-title h5 {
          font-size: 16px;
        }
        
        .user-info-compact {
          font-size: 12px;
        }
        
        .logout-btn-top {
          padding: 6px 12px;
          font-size: 12px;
        }
        
        .login-btn-top {
          padding: 6px 12px;
          font-size: 12px;
        }
        
        .container {
          padding: 20px 15px;
        }
      }
      
      /* í€µ ë„¤ë¹„ê²Œì´ì…˜ ë°” ìŠ¤íƒ€ì¼ */
      .quick-nav-bar {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .quick-nav-bar .btn {
        border-radius: 6px;
        font-weight: 500;
        transition: all 0.2s ease;
        text-decoration: none;
        white-space: nowrap;
      }

      .quick-nav-bar .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
      }

      .quick-nav-bar .btn i {
        font-size: 14px;
      }

      @media (max-width: 768px) {
        .quick-nav-bar {
          padding: 10px;
          margin: 0 -15px 20px;
          border-radius: 0;
        }
        
        .quick-nav-bar .d-flex {
          overflow-x: auto;
          scrollbar-width: none;
          -ms-overflow-style: none;
          padding-bottom: 5px;
        }
        
        .quick-nav-bar .d-flex::-webkit-scrollbar {
          display: none;
        }
        
        .quick-nav-bar .btn {
          flex-shrink: 0;
          font-size: 12px;
          padding: 6px 10px;
        }
        
        .quick-nav-bar .btn i {
          font-size: 12px;
        }
      }

      .container {
        max-width: 900px; /* Notion í˜ì´ì§€ ë„ˆë¹„ì™€ ìœ ì‚¬í•˜ê²Œ */
        margin: 0 auto; /* ì¤‘ì•™ ì •ë ¬ */
        padding: 30px; /* ì»¨í…ì¸  ì˜ì—­ íŒ¨ë”© */
      }

      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 15px;
        margin-bottom: 25px;
        border-bottom: 1px solid #edecec; /* Notion êµ¬ë¶„ì„ ê³¼ ìœ ì‚¬í•˜ê²Œ */
      }

      .page-title {
        font-size: 28px; /* Notion í˜ì´ì§€ ì œëª© í¬ê¸°ì™€ ìœ ì‚¬í•˜ê²Œ */
        font-weight: 700; /* Notion ì œëª© êµµê¸° */
        color: #1f1e1c; /* Notion ì œëª© ìƒ‰ìƒ */
      }

      .btn {
        display: inline-block;
        padding: 9px 16px; /* ë²„íŠ¼ íŒ¨ë”© ì¡°ì • */
        font-size: 14px;
        font-weight: 500;
        text-align: center;
        text-decoration: none;
        border-radius: 5px; /* Notion ë²„íŠ¼ ë‘¥ê¸€ê¸° */
        cursor: pointer;
        transition: background-color 0.2s, border-color 0.2s;
        border: 1px solid transparent; /* ê¸°ë³¸ í…Œë‘ë¦¬ íˆ¬ëª… */
      }

      .btn-primary {
        background-color: #2563eb; /* Notion ì£¼ìš” ë²„íŠ¼ ìƒ‰ìƒ */
        color: white;
        border-color: #2563eb;
      }

      .btn-primary:hover {
        background-color: #1d4ed8;
        border-color: #1d4ed8;
      }

      .btn-secondary {
        background-color: #ffffff;
        color: #37352f;
        border: 1px solid #e3e2e0; /* Notion ë³´ì¡° ë²„íŠ¼ í…Œë‘ë¦¬ */
      }

      .btn-secondary:hover {
        background-color: #f7f7f5; /* Notion ë³´ì¡° ë²„íŠ¼ í˜¸ë²„ ìƒ‰ìƒ */
      }

      .card-list {
        display: grid;
        grid-template-columns: repeat(
          auto-fill,
          minmax(280px, 1fr)
        ); /* ì¹´ë“œ ìµœì†Œ ë„ˆë¹„ ì¡°ì • */
        gap: 25px; /* ì¹´ë“œ ê°„ê²© ì¡°ì • */
      }

      .card {
        background-color: #ffffff;
        border: 1px solid #edecec; /* Notion ì¹´ë“œ í…Œë‘ë¦¬ */
        border-radius: 6px; /* Notion ì¹´ë“œ ë‘¥ê¸€ê¸° */
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.07), 0 1px 2px rgba(0, 0, 0, 0.03); /* Notion ì¹´ë“œ ê·¸ë¦¼ì */
        transition: box-shadow 0.2s;
      }
      .card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.05); /* í˜¸ë²„ ì‹œ ê·¸ë¦¼ì ê°•ì¡° */
      }

      .card-body {
        padding: 20px; /* ì¹´ë“œ ë‚´ë¶€ íŒ¨ë”© ì¡°ì • */
      }

      .card-title {
        font-size: 17px; /* ì¹´ë“œ ì œëª© í¬ê¸° ì¡°ì • */
        font-weight: 600;
        margin-top: 0;
        margin-bottom: 8px; /* ì œëª©ê³¼ ë¶€ì œëª© ì‚¬ì´ ê°„ê²© ì¡°ì • */
      }

      .card-title a {
        color: #37352f; /* ì¹´ë“œ ì œëª© ë§í¬ ìƒ‰ìƒ */
        text-decoration: none;
      }

      .card-title a:hover {
        text-decoration: underline;
      }      .card-subtitle {
        font-size: 13px; /* ì¹´ë“œ ë¶€ì œëª© í¬ê¸° ì¡°ì • */
        font-weight: 400;
        color: #787774; /* ì¹´ë“œ ë¶€ì œëª© ìƒ‰ìƒ */
        margin-bottom: 12px;
      }

      /* ëŒ€ì‹œë³´ë“œ í†µê³„ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
      .stat-card {
        border: 1px solid #e3e2e0;
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        transition: all 0.2s ease-in-out;
        min-height: 140px;
      }

      .stat-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        transform: translateY(-1px);
      }

      .stat-card .card-body {
        padding: 16px;
      }

      .stat-card .icon-wrapper {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 8px;
      }

      /* ì‘ì€ í™”ë©´ì—ì„œì˜ ë°˜ì‘í˜• ì¡°ì • */
      @media (max-width: 768px) {
        .stat-card .card-body {
          padding: 12px;
        }

        .stat-card h3 {
          font-size: 1.2rem;
        }

        .stat-card .btn-sm {
          font-size: 0.75rem;
          padding: 4px 8px;
        }

        .stat-card .icon-wrapper {
          width: 32px;
          height: 32px;
        }
      }

      /* ë§¤ìš° ì‘ì€ í™”ë©´ì—ì„œì˜ ì¡°ì • */
      @media (max-width: 576px) {
        .stat-card {
          min-height: 120px;
        }

        .stat-card .card-body {
          padding: 10px;
        }

        .stat-card h3 {
          font-size: 1.1rem;
        }

        .stat-card .card-title {
          font-size: 0.8rem;
        }
      }
      }

      .card-text {
        font-size: 14px;
        line-height: 1.6;
        color: #5c5a53; /* ì¹´ë“œ ë³¸ë¬¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
      }
      .card-text strong {
        color: #37352f; /* ê°•ì¡° í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
      }

      .text-muted {
        color: #9b9a97;
      }

      .text-center {
        text-align: center;
      }

      .mt-3 {
        margin-top: 1rem;
      }
      .mb-2 {
        margin-bottom: 0.5rem;      }
      /* ì¶”ê°€ì ì¸ Notion ìŠ¤íƒ€ì¼ ìš”ì†Œë“¤ (ì•„ì´ì½˜, í…Œì´ë¸”, í¼ ë“±)ì€ í•„ìš”ì— ë”°ë¼ í™•ì¥í•©ë‹ˆë‹¤. */

      /* ê¸€ë¡œë²Œ ë¡œë”© ìŠ¤í”¼ë„ˆ ìŠ¤íƒ€ì¼ */
      .global-loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(255, 255, 255, 0.9);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        backdrop-filter: blur(2px);
      }

      .loader-content {
        text-align: center;
        color: #37352f;
      }

      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #e3e2e0;
        border-top: 4px solid #2563eb;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 15px;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
      .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9998;
        max-width: 400px;
      }

      .toast {
        background-color: #ffffff;
        border: 1px solid #e3e2e0;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        margin-bottom: 10px;
        padding: 15px 20px;
        position: relative;
        display: flex;
        align-items: center;
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.3s ease;
      }

      .toast.show {
        opacity: 1;
        transform: translateX(0);
      }

      .toast.toast-success {
        border-left: 4px solid #198754;
      }

      .toast.toast-error {
        border-left: 4px solid #dc3545;
      }

      .toast.toast-warning {
        border-left: 4px solid #ffc107;
      }

      .toast.toast-info {
        border-left: 4px solid #0dcaf0;
      }

      .toast-icon {
        margin-right: 12px;
        font-size: 18px;
      }

      .toast-success .toast-icon {
        color: #198754;
      }

      .toast-error .toast-icon {
        color: #dc3545;
      }

      .toast-warning .toast-icon {
        color: #ffc107;
      }

      .toast-info .toast-icon {
        color: #0dcaf0;
      }

      .toast-message {
        flex-grow: 1;
        font-size: 14px;
        line-height: 1.4;
      }

      .toast-close {
        background: none;
        border: none;
        font-size: 18px;
        color: #787774;
        cursor: pointer;
        margin-left: 10px;
        padding: 0;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .toast-close:hover {
        color: #37352f;
      }      /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìµœì í™” - ê°•ì œ ì ìš© */
      @media (max-width: 768px) {
        /* ëª¨ë°”ì¼ CSS ì ìš© í™•ì¸ìš© - bodyì— ë°°ê²½ìƒ‰ ë³€ê²½ */
        body {
          flex-direction: column !important;
          padding-top: 60px !important;
          background-color: #f8f9fa !important; /* ëª¨ë°”ì¼ì—ì„œë§Œ íšŒìƒ‰ ë°°ê²½ */
        }

        /* ëª¨ë°”ì¼ í–„ë²„ê±° ë©”ë‰´ í‘œì‹œ */
        .mobile-menu-toggle {
          display: block !important;
        }        .main-nav {
          position: fixed;
          top: 0;
          left: -300px;
          width: 280px;
          height: 100vh;
          padding: 80px 20px 20px;
          border-right: none;
          border-bottom: none;
          box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
          z-index: 1050;
          transition: left 0.3s ease;
          overflow-y: auto;
          display: flex;
          flex-direction: column;
        }

        .main-nav.show {
          left: 0;
        }        .main-nav ul {
          display: block;
          flex-wrap: none;
          gap: 0;
          margin-bottom: 20px;
          flex-grow: 1;
          overflow-y: auto;
        }

        .main-nav ul li {
          flex: none;
          min-width: auto;
          margin-bottom: 5px;
        }

        .main-nav ul li a {
          text-align: left;
          font-size: 16px;
          padding: 15px;
          min-height: 44px; /* í„°ì¹˜ ì¹œí™”ì  */
          display: flex;
          align-items: center;
        }

        .main-nav ul li a i {
          margin-right: 12px;
          width: 20px;
          text-align: center;
        }

        /* ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ í‘œì‹œ */
        .mobile-overlay.show {
          display: block;
        }

        .main-content {
          width: 100%;
          padding: 15px;
        }

        .container {
          max-width: 100%;
          padding: 0 10px;
        }

        .page-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 15px;
          margin-bottom: 20px;
        }

        .page-title {
          font-size: 24px;
        }

        /* ë²„íŠ¼ ëª¨ë°”ì¼ ìµœì í™” */
        .btn {
          padding: 12px 16px;
          font-size: 16px;
          min-height: 44px;
          display: inline-flex;
          align-items: center;
          justify-content: center;
        }

        /* ì¹´ë“œ ëª¨ë°”ì¼ ìµœì í™” */
        .card {
          margin-bottom: 15px;
          border-radius: 8px;
        }

        .card-body {
          padding: 15px;
        }

        /* í…Œì´ë¸” ëª¨ë°”ì¼ ìµœì í™” */
        .table th,
        .table td {
          padding: 12px 8px;
          font-size: 14px;
          white-space: nowrap;
        }

        /* í¼ ëª¨ë°”ì¼ ìµœì í™” */
        .form-control,
        .form-select {
          min-height: 44px;
          font-size: 16px; /* iOS ì¤Œ ë°©ì§€ */
          border-radius: 8px;
        }

        /* ë“œë¡­ë‹¤ìš´ ëª¨ë°”ì¼ ìµœì í™” */
        .dropdown-menu {
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          margin-top: 8px;
        }

        .dropdown-item {
          padding: 12px 16px;
          font-size: 16px;
          min-height: 44px;
          display: flex;
          align-items: center;
        }        /* ëª¨ë‹¬ ëª¨ë°”ì¼ ìµœì í™” */
        .modal-dialog {
          margin: 20px;
          max-width: calc(100% - 40px);
        }

        .modal-content {
          border-radius: 12px;
        }        /* ëª¨ë°”ì¼ ìŠ¬ë¼ì´ë” ìŠ¤íƒ€ì¼ - ê°•ì œ ì ìš© */
        .mobile-slider {
          display: flex !important;
          overflow-x: auto !important;
          scroll-snap-type: x mandatory !important;
          gap: 15px !important;
          padding: 0 15px !important;
          margin: 0 -15px !important;
          scrollbar-width: none !important; /* Firefox */
          -ms-overflow-style: none !important; /* IE and Edge */
          background-color: #e3f2fd !important; /* ë””ë²„ê¹…ìš© - ìŠ¬ë¼ì´ë” ë°°ê²½ */
        }

        .mobile-slider::-webkit-scrollbar {
          display: none !important; /* Chrome, Safari */
        }

        .mobile-slider .card,
        .mobile-slider .stat-card {
          flex: 0 0 85% !important;
          scroll-snap-align: center !important;
          margin-bottom: 0 !important;
        }

        /* ëª¨ë°”ì¼ ê·¸ë˜í”„ ì»¨í…Œì´ë„ˆ - ê°•ì œ ì ìš© */
        .mobile-chart-slider {
          display: flex !important;
          overflow-x: auto !important;
          scroll-snap-type: x mandatory !important;
          gap: 20px !important;
          padding: 0 15px !important;
          margin: 0 -15px !important;
          scrollbar-width: none !important;
          -ms-overflow-style: none !important;
          background-color: #fff3e0 !important; /* ë””ë²„ê¹…ìš© - ì°¨íŠ¸ ìŠ¬ë¼ì´ë” ë°°ê²½ */
        }        .mobile-chart-slider::-webkit-scrollbar {
          display: none !important;
        }

        /* ëª¨ë°”ì¼ ì „ìš© í‘œì‹œ/ìˆ¨ê¹€ ê°•ì œ ì ìš© */
        .d-md-none {
          display: block !important;
        }

        .d-none.d-md-flex {
          display: none !important;
        }

        @media (min-width: 769px) {
          .d-md-none {
            display: none !important;
          }
          
          .d-none.d-md-flex {
            display: flex !important;
          }
        }

        .mobile-chart-slider .chart-container {
          flex: 0 0 90%;
          scroll-snap-align: center;
          min-height: 300px;
        }

        /* ëª¨ë°”ì¼ í•„í„° ë°•ìŠ¤ ìµœì í™” */
        .filter-box {
          padding: 10px;
          margin-bottom: 15px;
        }

        .filter-box .btn-group {
          display: flex;
          flex-wrap: wrap;
          gap: 5px;
        }

        .filter-box .btn {
          padding: 6px 10px;
          font-size: 12px;
          min-height: 32px;
          flex: 1;
          min-width: auto;
        }

        /* ëª¨ë°”ì¼ ì•¡ì…˜ ë²„íŠ¼ ìµœì í™” */
        .action-buttons {
          display: flex;
          flex-wrap: wrap;
          gap: 8px;
          margin-top: 10px;
        }

        .action-buttons .btn {
          padding: 8px 12px;
          font-size: 13px;
          min-height: 36px;
          flex: 1;
          min-width: auto;
        }

        /* ëª¨ë°”ì¼ í…Œì´ë¸” ìŠ¤í¬ë¡¤ */
        .table-responsive {
          border-radius: 8px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* ëª¨ë°”ì¼ ìº˜ë¦°ë” ìµœì í™” */
        .fc {
          font-size: 12px;
        }

        .fc-toolbar {
          flex-direction: column;
          gap: 10px;
        }

        .fc-toolbar-chunk {
          display: flex;
          justify-content: center;
          flex-wrap: wrap;
          gap: 5px;
        }

        .fc-button {
          padding: 6px 10px;
          font-size: 12px;
          min-height: 32px;
        }

        .fc-daygrid-day {
          min-height: 40px;
        }

        .fc-daygrid-day-number {
          font-size: 12px;
          padding: 4px;
        }

        .fc-event {
          font-size: 10px;
          padding: 1px 3px;
        }

        /* ëª¨ë°”ì¼ íˆìŠ¤í† ë¦¬ ì¹´ë“œ */
        .history-card {
          padding: 12px;
          margin-bottom: 10px;
        }

        .history-card .card-title {
          font-size: 14px;
          margin-bottom: 8px;
        }

        .history-card .card-text {
          font-size: 12px;
          line-height: 1.4;
        }

        /* ëª¨ë°”ì¼ ìƒì„¸ ì •ë³´ */
        .detail-info {
          padding: 10px;
          font-size: 14px;
        }

        .detail-info dt {
          font-size: 13px;
          font-weight: 600;
          margin-bottom: 4px;
        }

        .detail-info dd {
          font-size: 12px;
          margin-bottom: 8px;
        }
        }

        /* í†µê³„ ì¹´ë“œ ëª¨ë°”ì¼ ìµœì í™” */
        .row.mb-4 .col-lg-3,
        .row.mb-4 .col-md-6 {
          margin-bottom: 15px;
        }

        .card-hover {
          transition: transform 0.2s ease;
        }

        .card-hover:active {
          transform: scale(0.98);
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ ì‚¬ìš©ì ì•¡ì…˜ */
        .main-nav .user-actions a {
          padding: 15px;
          font-size: 16px;
          min-height: 44px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        /* ì°¨íŠ¸ ëª¨ë°”ì¼ ìµœì í™” */
        .chart-container {
          position: relative;
          height: 250px;
          margin-bottom: 20px;
        }

        /* ìº˜ë¦°ë” ëª¨ë°”ì¼ ìµœì í™” */
        .calendar-container {
          overflow-x: auto;
          -webkit-overflow-scrolling: touch;
        }

        /* í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì • */
        h1, .h1 { font-size: 24px; }
        h2, .h2 { font-size: 20px; }
        h3, .h3 { font-size: 18px; }
        h4, .h4 { font-size: 16px; }

        /* ìŠ¤í˜ì´ì‹± ì¡°ì • */
        .mb-4 { margin-bottom: 20px !important; }
        .mb-3 { margin-bottom: 15px !important; }
      }

        .page-title {
          font-size: 24px;
        }

        .card-list {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .toast-container {
          top: 10px;
          right: 10px;
          left: 10px;
          max-width: none;
        }

        .toast {
          margin-bottom: 8px;
        }
      }

      /* íƒœë¸”ë¦¿ ë°˜ì‘í˜• */
      @media (max-width: 1024px) and (min-width: 769px) {
        .card-list {
          grid-template-columns: repeat(2, 1fr);
        }
      }
    </style>
  </head>  <body>
    <!-- ëª¨ë°”ì¼ í–„ë²„ê±° ë©”ë‰´ -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle">
      <i class="fas fa-bars"></i>
    </button>

    <!-- ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- ê¸€ë¡œë²Œ ë¡œë”© ìŠ¤í”¼ë„ˆ -->
    <div id="globalLoader" class="global-loader">
      <div class="loader-content">
        <div class="spinner"></div>
        <p>ë¡œë”© ì¤‘...</p>
      </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ -->
    <div id="toastContainer" class="toast-container"></div>    <nav class="main-nav" id="mainNav">
      <!-- ë¡œê³  ë§í¬ - ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ ë‹¤ë¥´ê²Œ -->
      {% if user.is_authenticated %}
      <a href="{% url 'reporting:dashboard' %}" class="logo">Sales System</a>
      {% else %}
      <a href="{% url 'reporting:login' %}" class="logo">Sales System</a>
      {% endif %}
      <!-- ë¡œê³  ë§í¬ ëŒ€ì‹œë³´ë“œë¡œ ë³€ê²½ -->
      <ul>
        <!-- ëŒ€ì‹œë³´ë“œ ë©”ë‰´ - ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ -->
        {% if user.is_authenticated %}
        <li>
          <a
            href="{% url 'reporting:dashboard' %}"
            class="{% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
            ><i class="fas fa-home me-2"></i>ëŒ€ì‹œë³´ë“œ</a
          >
        </li>
        {% endif %}

        <!-- Admin ì „ìš© ë©”ë‰´ -->
        {% if user.is_authenticated and user.userprofile.role == 'admin' %}
        <li>
          <a
            href="{% url 'reporting:user_list' %}"
            class="{% if request.resolver_match.url_name|slice:':4' == 'user' %}active{% endif %}"
            ><i class="fas fa-users me-2"></i>ì‚¬ìš©ì ê´€ë¦¬</a
          >
        </li>
        {% endif %}

        <!-- Manager ì „ìš© ì‚¬ìš©ì ê´€ë¦¬ ë©”ë‰´ -->
        {% if user.is_authenticated and user.userprofile.role == 'manager' %}
        <li>
          <a
            href="{% url 'reporting:manager_user_list' %}"
            class="{% if request.resolver_match.url_name|slice:':12' == 'manager_user' %}active{% endif %}"
            ><i class="fas fa-user-friends me-2"></i>ì§ì› ê´€ë¦¬</a
          >
        </li>
        {% endif %}

        <!-- Admin & Salesman ì—…ì²´ ê´€ë¦¬ ë©”ë‰´ -->
        {% if user.is_authenticated and user.userprofile.role == 'admin' or user.is_authenticated and user.userprofile.role == 'salesman' %}
        <li>
          <a
            href="{% url 'reporting:company_list' %}"
            class="{% if request.resolver_match.url_name|slice:':7' == 'company' or request.resolver_match.url_name|slice:':10' == 'department' %}active{% endif %}"
            ><i class="fas fa-building me-2"></i>ì—…ì²´ ê´€ë¦¬</a
          >
        </li>
        {% endif %}

        <!-- Manager ì „ìš© ë©”ë‰´ -->
        {% if user.is_authenticated and user.userprofile.role == 'manager' %}
        <li>
          <a
            href="{% url 'reporting:customer_report' %}"
            class="{% if request.resolver_match.url_name == 'customer_report' or request.resolver_match.url_name == 'customer_detail_report' %}active{% endif %}"
            ><i class="fas fa-chart-bar me-2"></i>ê³ ê° ë¦¬í¬íŠ¸</a
          >
        </li>
        <li>
          <a
            href="{% url 'reporting:manager_company_list' %}"
            class="{% if request.resolver_match.url_name|slice:':15' == 'manager_company' %}active{% endif %}"
            ><i class="fas fa-building me-2"></i>ì—…ì²´ ì¡°íšŒ</a
          >
        </li>
        {% endif %}

        <!-- Salesman & Admin ê³µí†µ ë©”ë‰´ -->
        {% if user.is_authenticated and user.userprofile.role != 'manager' %}
        <li>
          <a
            href="{% url 'reporting:followup_list' %}"
            class="{% if request.resolver_match.url_name|slice:':8' == 'followup' %}active{% endif %}"
            ><i class="fas fa-user-check me-2"></i>íŒ”ë¡œìš°ì—…</a
          >
        </li>
        <li>
          <a
            href="{% url 'reporting:schedule_list' %}"
            class="{% if request.resolver_match.url_name == 'schedule_list' %}active{% endif %}"
            ><i class="fas fa-list me-2"></i>ì¼ì • ëª©ë¡</a
          >
        </li>
        <li>
          <a
            href="{% url 'reporting:schedule_calendar' %}"
            class="{% if request.resolver_match.url_name == 'schedule_calendar' %}active{% endif %}"
            ><i class="fas fa-calendar me-2"></i>ì¼ì • ìº˜ë¦°ë”</a
          >
        </li>
        <li>
          <a
            href="{% url 'reporting:history_list' %}"
            class="{% if request.resolver_match.url_name|slice:':7' == 'history' %}active{% endif %}"
            ><i class="fas fa-history me-2"></i>íˆìŠ¤í† ë¦¬</a
          >
        </li>
        <li>
          <a
            href="{% url 'reporting:customer_report' %}"
            class="{% if request.resolver_match.url_name|slice:':8' == 'customer' %}active{% endif %}"
            ><i class="fas fa-chart-bar me-2"></i>ê³ ê° ë¦¬í¬íŠ¸</a
          >
        </li>
        {% endif %}
      </ul>
    </nav>
    <main class="main-content">
      <!-- ìƒë‹¨ í—¤ë” ë°” -->
      <div class="top-header-bar">
        <div class="container-fluid d-flex justify-content-between align-items-center">
          <div class="page-title">
            <h5 class="mb-0">{% block page_title %}ì˜ì—… ë³´ê³  ì‹œìŠ¤í…œ{% endblock %}</h5>
          </div>
          <div class="user-actions-top">
            {% if user.is_authenticated %}
            <span class="user-info-compact me-3">
              <i class="fas fa-user me-1"></i>{{ user.username }}
              {% if user.userprofile %}
              <small class="text-muted ms-1">({{ user.userprofile.get_role_display }})</small>
              {% endif %}
            </span>
            <button id="logoutBtn" onclick="confirmLogout()" class="logout-btn-top">
              <i class="fas fa-sign-out-alt me-1"></i>ë¡œê·¸ì•„ì›ƒ
            </button>
            {% else %}
            <a href="{% url 'reporting:login' %}" class="login-btn-top">
              <i class="fas fa-sign-in-alt me-1"></i>ë¡œê·¸ì¸
            </a>
            {% endif %}
          </div>
        </div>
      </div>
      
      <div class="container">
        <!-- Django Messages í‘œì‹œ -->
        {% if messages %}
        <script>
          document.addEventListener('DOMContentLoaded', function() {
            {% for message in messages %}
            {% if message.tags == 'success' %}
              ToastManager.success('{{ message|escapejs }}');
            {% elif message.tags == 'error' %}
              ToastManager.error('{{ message|escapejs }}');
            {% elif message.tags == 'warning' %}
              ToastManager.warning('{{ message|escapejs }}');
            {% else %}
              ToastManager.info('{{ message|escapejs }}');
            {% endif %}
            {% endfor %}
          });
        </script>
        {% endif %} 
        
        <!-- í€µ ë„¤ë¹„ê²Œì´ì…˜ ë°” (ëŒ€ì‹œë³´ë“œ ì œì™¸) -->
        {% if user.is_authenticated and request.resolver_match.url_name != 'dashboard' and request.resolver_match.url_name != 'manager_dashboard' %}
        <div class="quick-nav-bar mb-4">
          <div class="d-flex flex-wrap gap-2 justify-content-center">
            <a href="{% url 'reporting:dashboard' %}" class="btn btn-sm btn-outline-dark">
              <i class="fas fa-home me-1"></i>ëŒ€ì‹œë³´ë“œ
            </a>
            
            {% if user.is_authenticated and user.userprofile.role != 'manager' %}
            <a href="{% url 'reporting:followup_list' %}" class="btn btn-sm btn-outline-primary">
              <i class="fas fa-user-check me-1"></i>íŒ”ë¡œìš°ì—…
            </a>
            <a href="{% url 'reporting:schedule_list' %}" class="btn btn-sm btn-outline-info">
              <i class="fas fa-list me-1"></i>ì¼ì • ëª©ë¡
            </a>
            <a href="{% url 'reporting:schedule_calendar' %}" class="btn btn-sm btn-outline-success">
              <i class="fas fa-calendar me-1"></i>ì¼ì • ìº˜ë¦°ë”
            </a>
            <a href="{% url 'reporting:history_list' %}" class="btn btn-sm btn-outline-warning">
              <i class="fas fa-history me-1"></i>íˆìŠ¤í† ë¦¬
            </a>
            <a href="{% url 'reporting:company_list' %}" class="btn btn-sm btn-outline-secondary">
              <i class="fas fa-building me-1"></i>ì—…ì²´ê´€ë¦¬
            </a>
            {% endif %}
            
            {% if user.is_authenticated and user.userprofile.role == 'manager' %}
            <a href="{% url 'reporting:manager_dashboard' %}" class="btn btn-sm btn-outline-primary">
              <i class="fas fa-chart-line me-1"></i>Manager ëŒ€ì‹œë³´ë“œ
            </a>
            <a href="{% url 'reporting:schedule_calendar' %}{% if request.GET.user %}?user={{ request.GET.user }}{% endif %}" class="btn btn-sm btn-outline-info">
              <i class="fas fa-calendar-alt me-1"></i>ì¼ì • ìº˜ë¦°ë”
            </a>
            <a href="{% url 'reporting:manager_company_list' %}" class="btn btn-sm btn-outline-secondary">
              <i class="fas fa-building me-1"></i>ì—…ì²´ ì¡°íšŒ
            </a>
            <a href="{% url 'reporting:manager_user_list' %}" class="btn btn-sm btn-outline-warning">
              <i class="fas fa-user-friends me-1"></i>ì§ì› ê´€ë¦¬
            </a>
            {% endif %}

            {% if user.is_authenticated and user.userprofile.role == 'admin' %}
            <a href="{% url 'reporting:user_list' %}" class="btn btn-sm btn-outline-danger">
              <i class="fas fa-users me-1"></i>ì‚¬ìš©ì ê´€ë¦¬
            </a>
            {% endif %}
          </div>
        </div>
        {% endif %}

        {% block content %}
        <!-- í˜ì´ì§€ë³„ ì»¨í…ì¸ ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤. -->
        {% endblock %}
      </div>
    </main>
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>    <!-- ê¸€ë¡œë²Œ JavaScript ìœ í‹¸ë¦¬í‹° -->
    <script>
      // ì „ì—­ CSRF í† í° í•¨ìˆ˜
      function getCSRFToken() {
        // 1. ë©”íƒ€ íƒœê·¸ì—ì„œ ê°€ì ¸ì˜¤ê¸°
        const csrfMeta = document.querySelector('meta[name="csrf-token"]');
        if (csrfMeta && csrfMeta.getAttribute("content")) {
          return csrfMeta.getAttribute("content");
        }
        
        // 2. ì¿ í‚¤ì—ì„œ ê°€ì ¸ì˜¤ê¸°
        const csrfCookie = document.cookie.split(';')
          .find(cookie => cookie.trim().startsWith('csrftoken='));
        if (csrfCookie) {
          return csrfCookie.split('=')[1];
        }
        
        // 3. í¼ì˜ hidden inputì—ì„œ ê°€ì ¸ì˜¤ê¸°
        const csrfInput = document.querySelector('input[name="csrfmiddlewaretoken"]');
        if (csrfInput && csrfInput.value) {
          return csrfInput.value;
        }
        
        console.warn('CSRF token not found!');
        return '';
      }

      // AJAX ìš”ì²­ì„ ìœ„í•œ ì „ì—­ ì„¤ì •
      function setupCSRFForAjax() {
        const csrfToken = getCSRFToken();
        
        // fetch APIë¥¼ ìœ„í•œ ê¸°ë³¸ í—¤ë” ì„¤ì • í•¨ìˆ˜
        window.fetchWithCSRF = function(url, options = {}) {
          const defaultOptions = {
            headers: {
              'X-CSRFToken': csrfToken,
              'Content-Type': 'application/json',
              ...options.headers
            }
          };
          return fetch(url, { ...defaultOptions, ...options });
        };
      }

      // ê¸€ë¡œë²Œ ë¡œë”© ìŠ¤í”¼ë„ˆ ê´€ë¦¬
      const GlobalLoader = {
        show() {
          document.getElementById("globalLoader").style.display = "flex";
        },
        hide() {
          document.getElementById("globalLoader").style.display = "none";
        },
      };

      // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ì‹œìŠ¤í…œ
      const ToastManager = {
        show(message, type = "info", duration = 5000) {
          const container = document.getElementById("toastContainer");
          const toast = document.createElement("div");
          toast.className = `toast toast-${type}`;

          const icons = {
            success: "fas fa-check-circle",
            error: "fas fa-exclamation-circle",
            warning: "fas fa-exclamation-triangle",
            info: "fas fa-info-circle",
          };

          toast.innerHTML = `
            <i class="toast-icon ${icons[type] || icons.info}"></i>
            <div class="toast-message">${message}</div>
            <button class="toast-close" onclick="this.parentElement.remove()">
              <i class="fas fa-times"></i>
            </button>
          `;

          container.appendChild(toast);

          // ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ í‘œì‹œ
          setTimeout(() => toast.classList.add("show"), 10);

          // ìë™ ì‚­ì œ
          setTimeout(() => {
            toast.classList.remove("show");
            setTimeout(() => toast.remove(), 300);
          }, duration);
        },

        success(message, duration) {
          this.show(message, "success", duration);
        },

        error(message, duration) {
          this.show(message, "error", duration);
        },

        warning(message, duration) {
          this.show(message, "warning", duration);
        },

        info(message, duration) {
          this.show(message, "info", duration);
        },
      };

      // í¼ ì œì¶œ ì‹œ ë¡œë”© í‘œì‹œ
      document.addEventListener("DOMContentLoaded", function () {
        // ëª¨ë“  í¼ì— ì œì¶œ ì‹œ ë¡œë”© ìŠ¤í”¼ë„ˆ í‘œì‹œ
        document.querySelectorAll("form").forEach((form) => {
          form.addEventListener("submit", function () {
            GlobalLoader.show();
          });
        });

        // ëª¨ë“  ë§í¬ í´ë¦­ ì‹œ ë¡œë”© í‘œì‹œ (ì™¸ë¶€ ë§í¬ ì œì™¸)
        document.querySelectorAll("a[href]").forEach((link) => {
          if (link.hostname === window.location.hostname || !link.hostname) {
            link.addEventListener("click", function (e) {
              if (!this.target || this.target === "_self") {
                GlobalLoader.show();
              }
            });
          }
        });

        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ë¡œë”© ìŠ¤í”¼ë„ˆ ìˆ¨ê¹€
        window.addEventListener("load", function () {
          GlobalLoader.hide();
        });

        // Ajax ìš”ì²­ ì¤‘ ë¡œë”© í‘œì‹œ (jQueryê°€ ìˆëŠ” ê²½ìš°)
        if (typeof $ !== "undefined") {
          $(document)
            .ajaxStart(function () {
              GlobalLoader.show();
            })
            .ajaxStop(function () {
              GlobalLoader.hide();
            });
        }
      });

      // ì—ëŸ¬ ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹°
      const ErrorHandler = {
        handle(error, userMessage = "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.") {
          console.error("Application Error:", error);
          ToastManager.error(userMessage);
          GlobalLoader.hide();
        },

        network(error) {
          this.handle(error, "ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
        },

        validation(message) {
          ToastManager.warning(message || "ì…ë ¥ê°’ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
        },
      };      // ë¡œê·¸ì•„ì›ƒ í™•ì¸ í•¨ìˆ˜
      function confirmLogout() {
        // ì»¤ìŠ¤í…€ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ (ë” ì„¸ë ¨ëœ ìŠ¤íƒ€ì¼)
        const result = confirm(
          "ğŸšª ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní˜„ì¬ ì‘ì—… ì¤‘ì¸ ë‚´ìš©ì´ ìˆë‹¤ë©´ ì €ì¥ í›„ ë¡œê·¸ì•„ì›ƒí•´ì£¼ì„¸ìš”."
        );

        if (result) {
          // ë¡œê·¸ì•„ì›ƒ ì§„í–‰ ë©”ì‹œì§€ í‘œì‹œ
          ToastManager.info("ë¡œê·¸ì•„ì›ƒ ì¤‘ì…ë‹ˆë‹¤...", 2000);
          GlobalLoader.show();

          // ì•½ê°„ì˜ ì§€ì—° í›„ ë¡œê·¸ì•„ì›ƒ ì‹¤í–‰ (UX ê°œì„ )
          setTimeout(() => {
            const form = document.createElement("form");
            form.method = "POST";
            form.action = '{% url "reporting:logout" %}';

            // CSRF í† í° ì¶”ê°€
            const csrfInput = document.createElement("input");
            csrfInput.type = "hidden";
            csrfInput.name = "csrfmiddlewaretoken";
            csrfInput.value = "{{ csrf_token }}";
            form.appendChild(csrfInput);

            document.body.appendChild(form);
            form.submit();
          }, 500);
        }
      }

      // ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
      window.addEventListener("error", function (e) {
        ErrorHandler.handle(e.error, "ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      });

      window.addEventListener("unhandledrejection", function (e) {
        ErrorHandler.handle(e.reason, "ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      });

      // ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ ê´€ë¦¬ ê°œì„ 
      (function () {
        // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ì²˜ë¦¬
        window.addEventListener("pageshow", function (event) {
          // ë¸Œë¼ìš°ì € ìºì‹œì—ì„œ í˜ì´ì§€ê°€ ë¡œë“œë˜ì—ˆì„ ë•Œ ìƒˆë¡œê³ ì¹¨
          if (event.persisted) {
            window.location.reload();
          }
        });

        // ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ ìƒíƒœ ê´€ë¦¬
        window.addEventListener("popstate", function (event) {
          // ë¡œë”© ìŠ¤í”¼ë„ˆ ìˆ¨ê¸°ê¸° (í˜¹ì‹œ ë‚¨ì•„ìˆì„ ê²½ìš°)
          if (typeof GlobalLoader !== "undefined") {
            GlobalLoader.hide();
          }
        });

        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.addEventListener("beforeunload", function () {
          // ì§„í–‰ ì¤‘ì¸ AJAX ìš”ì²­ì´ ìˆë‹¤ë©´ ì •ë¦¬
          if (typeof GlobalLoader !== "undefined") {
            GlobalLoader.hide();
          }
        });

        // ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ê°ì§€
        window.addEventListener("online", function () {
          if (typeof ToastManager !== "undefined") {
            ToastManager.success("ì¸í„°ë„· ì—°ê²°ì´ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤.", 3000);
          }
        });

        window.addEventListener("offline", function () {
          if (typeof ToastManager !== "undefined") {
            ToastManager.warning("ì¸í„°ë„· ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤.", 5000);
          }
        });

        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì´ˆê¸°í™”
        document.addEventListener("DOMContentLoaded", function () {
          // ëª¨ë“  í¼ ì œì¶œ ì‹œ ë¡œë”© í‘œì‹œ
          const forms = document.querySelectorAll("form:not([data-no-loader])");
          forms.forEach(function (form) {
            form.addEventListener("submit", function () {
              if (typeof GlobalLoader !== "undefined") {
                GlobalLoader.show();
              }
            });
          });

          // ëª¨ë“  ë§í¬ì— ëŒ€í•œ ì²˜ë¦¬
          const links = document.querySelectorAll(
            'a[href]:not([target="_blank"]):not([data-no-loader])'
          );
          links.forEach(function (link) {
            link.addEventListener("click", function (event) {
              // ì™¸ë¶€ ë§í¬ë‚˜ íŠ¹ìˆ˜ ë§í¬ëŠ” ì œì™¸
              const href = link.getAttribute("href");
              if (
                href &&
                !href.startsWith("#") &&
                !href.startsWith("javascript:") &&
                !href.startsWith("mailto:") &&
                !href.startsWith("tel:")
              ) {
                if (typeof GlobalLoader !== "undefined") {
                  GlobalLoader.show();
                }

                // 3ì´ˆ í›„ì—ë„ í˜ì´ì§€ê°€ ë¡œë“œë˜ì§€ ì•Šìœ¼ë©´ ë¡œë”© ìˆ¨ê¸°ê¸°
                setTimeout(function () {
                  if (typeof GlobalLoader !== "undefined") {
                    GlobalLoader.hide();
                  }
                }, 3000);
              }            });
          });
        });
      })();      // ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜ í† ê¸€ ê¸°ëŠ¥ ë° ì „ì²´ ì´ˆê¸°í™”
      document.addEventListener('DOMContentLoaded', function() {
        // CSRF ì„¤ì • ì´ˆê¸°í™”
        setupCSRFForAjax();
        
        // ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜ ì„¤ì •
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const mainNav = document.getElementById('mainNav');
        const mobileOverlay = document.getElementById('mobileOverlay');

        if (mobileMenuToggle && mainNav && mobileOverlay) {
          console.log('Mobile navigation elements found'); // ë””ë²„ê¹…ìš©
          
          // í–„ë²„ê±° ë©”ë‰´ í´ë¦­ ì‹œ ì‚¬ì´ë“œë°” í† ê¸€
          mobileMenuToggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            console.log('Mobile menu toggle clicked'); // ë””ë²„ê¹…ìš©
            
            mainNav.classList.toggle('show');
            mobileOverlay.classList.toggle('show');
            document.body.style.overflow = mainNav.classList.contains('show') ? 'hidden' : '';
          });

          // ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ ì‚¬ì´ë“œë°” ë‹«ê¸°
          mobileOverlay.addEventListener('click', function(e) {
            e.preventDefault();
            mainNav.classList.remove('show');
            mobileOverlay.classList.remove('show');
            document.body.style.overflow = '';
          });

          // ë„¤ë¹„ê²Œì´ì…˜ ë§í¬ í´ë¦­ ì‹œ ë©”ë‰´ ë‹«ê¸°
          const navLinks = mainNav.querySelectorAll('a');
          navLinks.forEach(function(link) {
            link.addEventListener('click', function() {
              if (window.innerWidth <= 768) {
                mainNav.classList.remove('show');
                mobileOverlay.classList.remove('show');
                document.body.style.overflow = '';
              }
            });
          });

          // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ëª¨ë°”ì¼ ë©”ë‰´ ì´ˆê¸°í™”
          window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
              mainNav.classList.remove('show');
              mobileOverlay.classList.remove('show');
              document.body.style.overflow = '';
            }
          });

          // ESC í‚¤ë¡œ ì‚¬ì´ë“œë°” ë‹«ê¸°
          document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && mainNav.classList.contains('show')) {
              mainNav.classList.remove('show');
              mobileOverlay.classList.remove('show');
              document.body.style.overflow = '';
            }
          });
        } else {
          console.log('Mobile navigation elements not found:', {
            mobileMenuToggle: !!mobileMenuToggle,
            mainNav: !!mainNav,
            mobileOverlay: !!mobileOverlay
          });
        }
      });
    </script>
  </body>
</html>
