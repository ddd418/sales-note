{% extends 'reporting/base.html' %}
{% load static %}

{% block content %}
<div class="container py-4">
    <!-- 헤더 -->
    <div class="mb-4">
        <a href="{% url 'reporting:opportunity_label_list' %}" class="text-muted text-decoration-none">
            <i class="fas fa-arrow-left me-1"></i> 라벨 목록으로
        </a>
        <h4 class="mt-2 mb-1">
            <i class="fas fa-{% if label %}edit{% else %}plus{% endif %} text-primary"></i>
            {% if label %}라벨 수정{% else %}새 라벨 생성{% endif %}
        </h4>
    </div>

    <!-- 폼 -->
    <div class="card border-0 shadow-sm" style="max-width: 600px;">
        <div class="card-body p-4">
            <form method="post">
                {% csrf_token %}
                
                <div class="mb-3">
                    <label for="name" class="form-label fw-bold">라벨명 <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="name" name="name" 
                           value="{% if label %}{{ label.name }}{% endif %}" 
                           placeholder="예: 대형 프로젝트, 신규 거래선, 재구매 고객" required>
                </div>
                
                <div class="mb-3">
                    <label for="color" class="form-label fw-bold">색상 <span class="text-danger">*</span></label>
                    <div class="d-flex gap-2 align-items-center">
                        <input type="color" class="form-control form-control-color" id="color" name="color" 
                               value="{% if label %}{{ label.color }}{% else %}#667eea{% endif %}" 
                               title="라벨 색상 선택">
                        <input type="text" class="form-control" id="colorText" 
                               value="{% if label %}{{ label.color }}{% else %}#667eea{% endif %}" 
                               style="width: 100px;" readonly>
                        <span class="badge" id="colorPreview" style="background-color: {% if label %}{{ label.color }}{% else %}#667eea{% endif %}; color: white; padding: 8px 16px;">
                            <i class="fas fa-tag me-1"></i> 미리보기
                        </span>
                    </div>
                    <div class="mt-2">
                        <small class="text-muted">추천 색상:</small>
                        <div class="d-flex gap-1 mt-1">
                            <button type="button" class="btn btn-sm color-preset" data-color="#667eea" style="background-color: #667eea; width: 28px; height: 28px; border-radius: 50%;"></button>
                            <button type="button" class="btn btn-sm color-preset" data-color="#764ba2" style="background-color: #764ba2; width: 28px; height: 28px; border-radius: 50%;"></button>
                            <button type="button" class="btn btn-sm color-preset" data-color="#10b981" style="background-color: #10b981; width: 28px; height: 28px; border-radius: 50%;"></button>
                            <button type="button" class="btn btn-sm color-preset" data-color="#f59e0b" style="background-color: #f59e0b; width: 28px; height: 28px; border-radius: 50%;"></button>
                            <button type="button" class="btn btn-sm color-preset" data-color="#ef4444" style="background-color: #ef4444; width: 28px; height: 28px; border-radius: 50%;"></button>
                            <button type="button" class="btn btn-sm color-preset" data-color="#3b82f6" style="background-color: #3b82f6; width: 28px; height: 28px; border-radius: 50%;"></button>
                            <button type="button" class="btn btn-sm color-preset" data-color="#8b5cf6" style="background-color: #8b5cf6; width: 28px; height: 28px; border-radius: 50%;"></button>
                            <button type="button" class="btn btn-sm color-preset" data-color="#ec4899" style="background-color: #ec4899; width: 28px; height: 28px; border-radius: 50%;"></button>
                        </div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <label for="description" class="form-label fw-bold">설명</label>
                    <textarea class="form-control" id="description" name="description" rows="3" 
                              placeholder="라벨에 대한 간단한 설명을 입력하세요 (선택사항)">{% if label %}{{ label.description }}{% endif %}</textarea>
                </div>
                
                <div class="d-flex justify-content-end gap-2">
                    <a href="{% url 'reporting:opportunity_label_list' %}" class="btn btn-outline-secondary">취소</a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-1"></i>
                        {% if label %}저장{% else %}생성{% endif %}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const colorInput = document.getElementById('color');
    const colorText = document.getElementById('colorText');
    const colorPreview = document.getElementById('colorPreview');
    const colorPresets = document.querySelectorAll('.color-preset');
    
    // 색상 입력 변경 시
    colorInput.addEventListener('input', function() {
        colorText.value = this.value;
        colorPreview.style.backgroundColor = this.value;
    });
    
    // 프리셋 색상 클릭 시
    colorPresets.forEach(function(btn) {
        btn.addEventListener('click', function() {
            const color = this.dataset.color;
            colorInput.value = color;
            colorText.value = color;
            colorPreview.style.backgroundColor = color;
        });
    });
});
</script>
{% endblock %}
